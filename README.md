# Yandex-practicum-forecasting-taxi-orders-using-time-series-analysis

Служба такси собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.
Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

<b>Цель исследования:</b> построить модель для прогнозирования количества заказов такси на следующий час на основании исторических данных.

<b>Этапы исследования</b>

1. Загрузка и изучение данных.
2. Предобработка данных.
3. Анализ данных.
4. Обучение моделей.
5. Сравнение моделей и выбор лучшей модели.
6. Тестирование выбранной модели.

Передо мной стояла задача построить модель с наилучшим значением метрики RMSE для прогнозирования количества заказов такси на следующий час на основании исторических данных.

1. Чтение и изучение данных.

Исходные данные содержат два столбца (дата/время и количество заказов за единицу времени) и 26496 строк. При чтении столбец, содержащий дату и время был преобразован в индекс и проверен на хронологичность и пропуски. Индексы хронологичны и пропусков в них нет. Название столбца соответствует стандарту. Данные представляют из себя временной ряд. Для дальнейшего анализа данные в таблице были сэмплированы с дискретом в один час. Пропусков в данных нет.

2. Анализ данных.

Данные описывают интервал времени в несколько месяцев от 1 марта до 31 августа 2018 года. Этих данных недостаточно для определения ежегодной сезонности.

На основании графика временного ряда можно отметить о тренде на увеличение количества вызовов такси с течением времени.

Можно отметить высокий спрос на такси в ночь с воскресенья на понедельник и дальнейший спад спроса до среды. Затем спрос начинает расти и достигает максимума к вечеру пятницы-ночи на субботу. с вечера субботы до утра воскресенья - глубокий провал. К вечеру воскресенья спрос начинает расти и достигает максимума ночью с воскресенья на понедельник.

Высокий спрос в ночь с воскресенья на понедельник также подтверждают высокие выбросы в остатке.

Такое поведение спроса, скорее всего, связано с планированием людьми начала своего отдыха на конец недели (увеличение спроса на такси к вечеру пятницы)и окончания отпуска - на воскресенье (увеличение спроса к вечеру воскресенья).

Высокий спрос на такси в начале ночи сменяется глубоким провалом к шести утра. Дальше наблюдается подъемы в начале и конце рабочего дня и вновь высокий подъем к 12 часам ночи. Такой спрос отражает ритм жизни большинства людей.

В результате, отмечаю тренд на увеличение количества вызовов такси с течением времени и ежедневную и еженедельную сезонность.


3. Построение моделей.

Для построения моделей быля создана функция кросс-валидации, не перемешивающая данные.

Были постоены и проверены с помощью кросс-валидации модели линейная регрессия, эластичная сеть, случайный лес и градиентный бустинг LightGBM. Эластичная сеть показала значение метрики RMSE - 27.71, линейная регрессия - 27.64, случайный лес - 27.21. Лучшее значение метрики RMSE (26.63) показала модель градиентный бустинг LightGBM. Значения метрик RMSE у всех моделей ниже , чем у предсказания медианным значением, то есть все модели адекватны.

Рекомендую заказчику использовать модель градиентный бустинг LightGBM для предсказания количества заказов такси на следующий час.

4. Тестирование модели.

Выбранная модельградиентный бустинг LightGBM была протестирована. Ее значение метрики RMSE на тестовой выборке составило  41.9.

Модель  прошла проверку и может быть использована при прогнозировании количества заказов такси на следующий час.
